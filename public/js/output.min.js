function getPostalCode(place){for(var postalCode="",i=0;i<place.address_components.length;i++){var addressType=place.address_components[i].types[0];if("postal_code"==addressType){postalCode=place.address_components[i].short_name;break}}return postalCode}function validateAddresses(){var startPC=document.getElementById("startPostCode").value,startLan=document.getElementById("startAddressLat").value,startLong=document.getElementById("startAddressLong").value,destPC=document.getElementById("destPostCode").value,destLan=document.getElementById("destAddressLat").value,destLong=document.getElementById("destAddressLong").value;if(startLan&&startLong&&destLan&&destLong){if(addressWithinLoganRegion(startPC)||addressWithinLoganRegion(destPC))return document.getElementById("validation-errors").innerText="",!0;document.getElementById("validation-errors").innerText="At this point we require at least one address to be within the Logan city bounds."}else document.getElementById("validation-errors").innerText="Both addresses required";return!1}function addressWithinLoganRegion(postcode){return loganPostcodes.indexOf(postcode)>-1}google.maps.event.addDomListener(window,"load",function(){setTimeout(function(){var defaultBounds=new google.maps.LatLngBounds(new google.maps.LatLng(-27.641505,153.106308)),options={bounds:defaultBounds},startAddress=new google.maps.places.Autocomplete(document.getElementById("start-address"),options),destAddress=new google.maps.places.Autocomplete(document.getElementById("dest-address"),options);google.maps.event.addListener(startAddress,"place_changed",function(){var place=startAddress.getPlace(),latitude=(place.formatted_address,place.geometry.location.lat()),longitude=place.geometry.location.lng();document.getElementById("startPostCode").value=getPostalCode(place),document.getElementById("startAddressLat").value=latitude,document.getElementById("startAddressLong").value=longitude}),google.maps.event.addListener(destAddress,"place_changed",function(){var place=destAddress.getPlace(),latitude=(place.formatted_address,place.geometry.location.lat()),longitude=place.geometry.location.lng();document.getElementById("destPostCode").value=getPostalCode(place),document.getElementById("destAddressLat").value=latitude,document.getElementById("destAddressLong").value=longitude})},1e3)});var loganPostcodes=["4114","4117","4118","4119","4123","4124","4125","4127","4128","4129","4130","4131","4132","4133","4205","4207","4270","4280","4285"],app=angular.module("bus-meme",["ngRoute"]);app.config(function($routeProvider){$routeProvider.when("/",{templateUrl:"views/main.html",controller:"MapController"})}),app.controller("MapController",function($scope,MapService,$anchorScroll){function initStep2(){document.getElementById("map-results").className="showmap",document.getElementById("journey-details").className="done",$anchorScroll("map-results"),document.getElementById("summary-from").innerText=document.getElementById("start-address").value,document.getElementById("summary-to").innerText=document.getElementById("dest-address").value}var transitDirections,drivingOrWalkingDirections,map;$scope.transport={mode:"driving"},$scope.showMap=!1,$scope.getMapData=function(){if(validateAddresses()){$scope.showMap=!0,initMap();var travelOptions={startLat:document.getElementById("startAddressLat").value,startLng:document.getElementById("startAddressLong").value,destLat:document.getElementById("destAddressLat").value,destLng:document.getElementById("destAddressLong").value};MapService.getDirections(travelOptions,"public",function(result,status){$scope.$apply(function(){$scope["public"]={distance:result.routes[0].legs[0].distance.text,duration:result.routes[0].legs[0].duration.text}}),document.getElementById("public-duration").innerText=$scope["public"].duration,status==google.maps.DirectionsStatus.OK&&transitDirections.setDirections(result)}),MapService.getDirections(travelOptions,$scope.transport.mode,function(result,status){$scope.$apply(function(){$scope.other={distance:result.routes[0].legs[0].distance.text,duration:result.routes[0].legs[0].duration.text}}),document.getElementById("other-duration").innerText=$scope.other.duration,status==google.maps.DirectionsStatus.OK&&drivingOrWalkingDirections.setDirections(result)}),initStep2()}else document.getElementById("map-results").className="",document.getElementById("journey-details").className=""};var initMap=function(){var logan=new google.maps.LatLng(-27.6410476,153.10750899999994),mapOptions={zoom:11,center:logan,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("gmap_canvas"),mapOptions),transitDirections=new google.maps.DirectionsRenderer({map:map,polylineOptions:{strokeColor:"red"}}),drivingOrWalkingDirections=new google.maps.DirectionsRenderer({map:map,polylineOptions:{strokeColor:"blue"}})}}),app.factory("MapService",function(){return{getDirections:function(travelOptions,mode,callback){var directionsService=new google.maps.DirectionsService,start=new google.maps.LatLng(travelOptions.startLat,travelOptions.startLng),end=new google.maps.LatLng(travelOptions.destLat,travelOptions.destLng),request={origin:start,destination:end};switch(mode){case"driving":request.travelMode=google.maps.TravelMode.DRIVING;break;case"walking":request.travelMode=google.maps.TravelMode.WALKING;break;default:request.travelMode=google.maps.TravelMode.TRANSIT}directionsService.route(request,callback)}}});var app=angular.module("bus-meme");app.controller("MemeController",function($scope,MemeFactory,$anchorScroll){MemeFactory.getMemeTemplates().then(function(response){$scope.memeTemplates=response.data})}),app.factory("MemeFactory",["$http",function($http){return{getMemeTemplates:function(){return $http.get("/getMemeTemplates")}}}]);var app=angular.module("bus-meme");app.controller("TimeController",function($scope){function getSevenDays(){days=[];var date=new Date;days.push({label:"Today ("+weekdays[date.getDay()]+")",dateValue:date});for(var i=0;6>=i;i++)date.setDate(date.getDate()+1),days.push({label:getDateDisplayLabel(date),dateValue:date});return days}function getHours(){for(var hours=[],i=1;12>=i;i++)hours.push(i);return hours}function getMinutes(){for(var minutes=[],i=0;12>i;i++){var thisMinute=5*i;60==thisMinute&&(thisMinute=0),minutes.push(twoDigits(thisMinute))}return minutes}function setSelectedTime(){var date=new Date,hour=date.getHours(),roundedMinute=5*Math.ceil(date.getMinutes()/5);60==roundedMinute&&(roundedMinute=0,hour++),$scope.selectedAmpm=$scope.ampms[0],hour>12&&(hour-=12,$scope.selectedAmpm=$scope.ampms[1]),$scope.selectedMinute=$scope.minutes[roundedMinute/5],$scope.selectedHour=$scope.hours[hour-1]}function twoDigits(minute){return 10>minute?"0"+minute.toString():minute.toString()}function getDateDisplayLabel(date){return weekdays[date.getDay()].substr(0,3)+" "+date.getDate()+" "+months[date.getMonth()]+" "+date.getFullYear()}function getWalkingOptions(){var walkingOptions=[{label:"Up to 100m",value:"100"},{label:"Up to 250m",value:"250"},{label:"Up to 500m",value:"500"},{label:"Up to 1km",value:"1000"},{label:"Up to 1.5km",value:"1500"},{label:"Up to 2km",value:"2000"},{label:"Up to 4km",value:"4000"}];return walkingOptions}var weekdays=["","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];$scope.ampms=["am","pm"],$scope.days=getSevenDays(),$scope.selectedDate=$scope.days[0],$scope.hours=getHours(),$scope.minutes=getMinutes(),setSelectedTime(),$scope.timeOption=1,$scope.walkingOptions=getWalkingOptions(),$scope.selectedMaxWalk=$scope.walkingOptions[4]});